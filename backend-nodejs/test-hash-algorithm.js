/**
 * TESTE DE ALGORITMOS DE HASH - SEASON 19 DV TEAMS
 * Objetivo: Descobrir qual algoritmo o banco estรก usando
 */

const crypto = require('crypto');

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// CONFIGURAรรO
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

const PASSWORD = '123123';  // Senha de teste
const HASH_FROM_DB = '0244872fafb64a346d6f70665c5225288c3b984224595c8533a4a9720a1651c6';  // Hash do banco

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('โ  TESTE DE ALGORITMOS DE HASH - SEASON 19 DV TEAMS             โ');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ\n');

console.log(`๐ Senha de teste: "${PASSWORD}"`);
console.log(`๐ Hash do banco: ${HASH_FROM_DB}`);
console.log(`๐ Tamanho: ${HASH_FROM_DB.length} caracteres\n`);

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 1: MD5 (Season 6 comum)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 1: MD5 (Season 6)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const md5Hash = crypto.createHash('md5').update(PASSWORD).digest('hex');
console.log(`MD5 gerado:        ${md5Hash}`);
console.log(`Hash do banco:     ${HASH_FROM_DB}`);
console.log(`โ MATCH? ${md5Hash.toLowerCase() === HASH_FROM_DB.toLowerCase() ? 'SIM!' : 'NรO'}\n`);

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 2: SHA-256 (Season 19 padrรฃo)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 2: SHA-256 (Season 19 padrรฃo)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const sha256Hash = crypto.createHash('sha256').update(PASSWORD).digest('hex');
console.log(`SHA-256 gerado:    ${sha256Hash}`);
console.log(`Hash do banco:     ${HASH_FROM_DB}`);
console.log(`โ MATCH? ${sha256Hash.toLowerCase() === HASH_FROM_DB.toLowerCase() ? 'SIM!' : 'NรO'}\n`);

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 3: SHA-256 com Salt (GUID como salt)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 3: SHA-256 + GUID (alguns servidores custom)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const GUIDS_TO_TEST = [
  '1', '2', '3', '123', '1234', '12345',
  '0', '00000000', 'tiongas'
];

GUIDS_TO_TEST.forEach(guid => {
  const saltedHash = crypto.createHash('sha256').update(PASSWORD + guid).digest('hex');
  const match = saltedHash.toLowerCase() === HASH_FROM_DB.toLowerCase();
  
  if (match) {
    console.log(`๐ฏ ENCONTRADO! GUID: "${guid}"`);
    console.log(`   SHA-256("${PASSWORD}" + "${guid}") = ${saltedHash}`);
  }
});

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 4: Varbinary / Binary (WebEngine DV Teams)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 4: Varbinary / Binary String (DV Teams custom)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

// Converter hash do banco para Buffer (se for varbinary)
try {
  const hashBuffer = Buffer.from(HASH_FROM_DB, 'hex');
  console.log(`Buffer (hex): ${hashBuffer.toString('hex')}`);
  console.log(`Buffer (utf8): ${hashBuffer.toString('utf8')}`);
  console.log(`Buffer (base64): ${hashBuffer.toString('base64')}`);
  
  // Tentar decodificar como string
  const decoded = hashBuffer.toString('ascii');
  console.log(`Buffer (ascii): ${decoded}`);
} catch (err) {
  console.log('โ Nรฃo รฉ varbinary simples');
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 5: XOR Encryption (DV Teams antigo)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 5: XOR Encryption (DV Teams antigo)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

// XOR simples com chave comum do MU
const XOR_KEYS = [0x5E, 0x7F, 0x3A, 0xC5, 0x6D];

XOR_KEYS.forEach((key, index) => {
  let xorResult = '';
  for (let i = 0; i < PASSWORD.length; i++) {
    const charCode = PASSWORD.charCodeAt(i);
    const xorChar = charCode ^ key;
    xorResult += xorChar.toString(16).padStart(2, '0');
  }
  
  const match = xorResult.toLowerCase() === HASH_FROM_DB.toLowerCase();
  if (match) {
    console.log(`๐ฏ ENCONTRADO! XOR Key: 0x${key.toString(16).toUpperCase()}`);
    console.log(`   XOR("${PASSWORD}", 0x${key.toString(16)}) = ${xorResult}`);
  }
});

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 6: Algoritmo Customizado DV Teams
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 6: Algoritmo Custom DV Teams (SHA-256 + Username)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const usernames = ['tiongas', 'TIONGAS', 'Tiongas'];
usernames.forEach(username => {
  const customHash = crypto.createHash('sha256').update(username.toLowerCase() + PASSWORD).digest('hex');
  const match = customHash.toLowerCase() === HASH_FROM_DB.toLowerCase();
  
  if (match) {
    console.log(`๐ฏ ENCONTRADO! Username: "${username}"`);
    console.log(`   SHA-256("${username.toLowerCase()}" + "${PASSWORD}") = ${customHash}`);
  }
});

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 7: SHA-1 (usado em alguns DV Teams)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 7: SHA-1 (alguns DV Teams)');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const sha1Hash = crypto.createHash('sha1').update(PASSWORD).digest('hex');
console.log(`SHA-1 gerado:      ${sha1Hash}`);
console.log(`Hash do banco:     ${HASH_FROM_DB}`);
console.log(`โ MATCH? ${sha1Hash.toLowerCase() === HASH_FROM_DB.toLowerCase() ? 'SIM!' : 'NรO'}\n`);

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// TESTE 8: Plain Text (alguns bancos antigos)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('TESTE 8: Plain Text / Hex encoding');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');

const plainTextHex = Buffer.from(PASSWORD, 'utf8').toString('hex');
console.log(`Plain Text (hex):  ${plainTextHex}`);
console.log(`Hash do banco:     ${HASH_FROM_DB}`);
console.log(`โ MATCH? ${plainTextHex.toLowerCase() === HASH_FROM_DB.toLowerCase() ? 'SIM!' : 'NรO'}\n`);

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// RESUMO
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

console.log('\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
console.log('โ  RESUMO                                                        โ');
console.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ\n');

console.log('๐ Algoritmos testados:');
console.log('   1. MD5 (Season 6)');
console.log('   2. SHA-256 puro');
console.log('   3. SHA-256 + GUID salt');
console.log('   4. Varbinary/Binary');
console.log('   5. XOR Encryption');
console.log('   6. SHA-256 + Username');
console.log('   7. SHA-1');
console.log('   8. Plain Text (hex)\n');

console.log('๐ Prรณximo passo:');
console.log('   - Se NENHUM bateu: Consulte o GameServer do DV Teams');
console.log('   - Verificar arquivo: MuServer/Data/Common/ServerList.dat');
console.log('   - Ou: Verificar MuServer/SQL/HashingAlgorithm.txt\n');
